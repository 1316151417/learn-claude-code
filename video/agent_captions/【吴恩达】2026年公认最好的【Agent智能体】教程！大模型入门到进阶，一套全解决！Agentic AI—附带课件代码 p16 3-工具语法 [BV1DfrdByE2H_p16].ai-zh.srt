1
00:00:00,100 --> 00:00:03,520
让我们看看如何编写代码来拥有自己的get工具

2
00:00:03,520 --> 00:00:05,480
这里是我们之前的

3
00:00:05,480 --> 00:00:09,160
不带时区参数的获取当前时间函数

4
00:00:09,160 --> 00:00:12,480
让我展示如何使用ai套件开源库

5
00:00:12,480 --> 00:00:15,910
顺便说一下，要拥有自己的调用工具

6
00:00:15,910 --> 00:00:17,970
从上一个视频中可以看到

7
00:00:17,970 --> 00:00:20,030
语言模型不会调用工具

8
00:00:20,030 --> 00:00:22,650
语言模型只是请求你调用工具

9
00:00:22,650 --> 00:00:25,270
但在构建生成工作流的开发者中

10
00:00:25,270 --> 00:00:28,840
我们很多人偶尔会直接说语言模型调用工具

11
00:00:28,840 --> 00:00:31,360
尽管这在技术上并不准确

12
00:00:31,360 --> 00:00:34,340
但因为这是更简洁的说法

13
00:00:34,340 --> 00:00:40,980
这里的语法与调用语言模型的OpenAI语法非常相似

14
00:00:40,980 --> 00:00:43,960
不过这里我使用的是ai套件库

15
00:00:43,960 --> 00:00:47,220
这是一个我和一些朋友开发的开源包

16
00:00:47,220 --> 00:00:51,250
它能轻松调用多个语言模型提供商

17
00:00:51,250 --> 00:00:52,450
所以代码语法

18
00:00:52,450 --> 00:00:54,610
如果你觉得这看起来很多

19
00:00:54,610 --> 00:00:55,490
不用担心

20
00:00:55,490 --> 00:00:57,870
在代码实验室中你会看到更多

21
00:00:57,870 --> 00:01:01,140
但简而言之这与OpenAI语法非常相似

22
00:01:01,140 --> 00:01:01,740
你会说

23
00:01:01,740 --> 00:01:03,920
响应等于客户端检查完成

24
00:01:03,920 --> 00:01:04,360
创建

25
00:01:04,360 --> 00:01:05,519
然后选择模型

26
00:01:05,519 --> 00:01:08,740
这里我们将使用OpenAI模型

27
00:01:08,740 --> 00:01:13,720
Gp四消息等于消息假设你已将其放入数组

28
00:01:13,720 --> 00:01:15,600
要传递给语言模型的消息

29
00:01:15,600 --> 00:01:17,460
然后等于

30
00:01:17,460 --> 00:01:20,740
你希望语言模型访问的工具列表

31
00:01:20,740 --> 00:01:22,700
这里只有一个工具

32
00:01:22,700 --> 00:01:23,900
即获取当前时间

33
00:01:23,900 --> 00:01:27,270
无需过多担心最大轮次参数

34
00:01:27,270 --> 00:01:30,780
这是因为工具调用返回后

35
00:01:30,780 --> 00:01:32,880
模型可能会决定再次调用工具

36
00:01:32,880 --> 00:01:34,400
之后工具调用返回后

37
00:01:34,400 --> 00:01:36,420
模型可能再次调用另一个工具

38
00:01:36,420 --> 00:01:38,700
最大轮次只是设置一个上限

39
00:01:38,700 --> 00:01:42,240
你希望语言模型连续调用工具的次数

40
00:01:42,240 --> 00:01:45,660
在无限循环中停止

41
00:01:45,660 --> 00:01:48,220
实际上你几乎不会遇到这个限制

42
00:01:48,220 --> 00:01:51,990
除非代码有非常激进的操作

43
00:01:51,990 --> 00:01:55,170
所以我通常不关心最大轮次参数，一般设为五

44
00:01:55,170 --> 00:01:58,060
但实际上这并不重要

45
00:01:58,060 --> 00:01:59,940
使用ai套件后发现

46
00:01:59,940 --> 00:02:04,430
获取当前时间函数会自动描述给语言模型

47
00:02:04,430 --> 00:02:08,469
以便模型知道何时调用它

48
00:02:08,469 --> 00:02:11,509
无需手动编写长提示

49
00:02:11,509 --> 00:02:13,690
告诉模型获取当前时间

50
00:02:13,690 --> 00:02:16,750
ai套件的语法会自动处理

51
00:02:16,750 --> 00:02:18,670
为了让它看起来不那么神秘

52
00:02:18,670 --> 00:02:24,030
其实它是通过查看与get_current_time关联的文档字符串来实现的

53
00:02:24,030 --> 00:02:25,370
通过这些注释

54
00:02:25,370 --> 00:02:31,410
获取当前时间以便向语言模型描述此函数

55
00:02:31,410 --> 00:02:33,650
为了说明它是如何工作的

56
00:02:33,650 --> 00:02:35,890
这里是函数代码

57
00:02:35,890 --> 00:02:37,670
这里是一段代码片段

58
00:02:37,670 --> 00:02:41,219
使用AI套件在后台调用语言模型

59
00:02:41,219 --> 00:02:47,399
这将创建一个详细描述函数的JSON模式

60
00:02:47,399 --> 00:02:51,500
而这里右侧实际传递的是

61
00:02:51,500 --> 00:02:54,440
并将提取函数名称

62
00:02:54,440 --> 00:02:55,620
即当前时间

63
00:02:55,620 --> 00:03:00,060
然后从文档字符串中提取函数描述

64
00:03:00,060 --> 00:03:02,560
告知语言模型此函数的功能

65
00:03:02,560 --> 00:03:04,820
使其能决定何时调用

66
00:03:04,820 --> 00:03:09,620
有些API需要手动构建此JSON模式

67
00:03:09,620 --> 00:03:12,000
然后将JSON模式传递给

68
00:03:12,000 --> 00:03:17,560
但该包会自动为您处理以展示更复杂的示例

69
00:03:17,560 --> 00:03:24,540
如果你有包含输入时区参数的复杂get_current_time工具

70
00:03:24,540 --> 00:03:28,860
AI套件将创建更复杂的JSON模式

71
00:03:28,860 --> 00:03:32,040
同样提取函数名称get_current_time

72
00:03:32,040 --> 00:03:33,960
从文档字符串中提取描述

73
00:03:33,960 --> 00:03:38,660
并识别参数并描述给语言模型

74
00:03:38,660 --> 00:03:41,939
基于左侧显示的文档

75
00:03:41,939 --> 00:03:46,880
因此在生成函数调用参数时

76
00:03:46,880 --> 00:03:49,240
它知道应使用类似美国

77
00:03:49,240 --> 00:03:51,840
纽约或太平洋奥克兰

78
00:03:51,840 --> 00:03:53,740
或其他时区

79
00:03:53,740 --> 00:03:58,020
如果执行左侧下方的代码片段

80
00:03:58,020 --> 00:04:03,140
将使用OpenAI GPT-4模型调用函数

81
00:04:03,140 --> 00:04:04,760
如果需要则调用该函数

82
00:04:04,760 --> 00:04:08,130
获取函数输出并反馈给模型

83
00:04:08,130 --> 00:04:10,450
最多进行五轮交互

84
00:04:10,450 --> 00:04:17,620
然后返回响应注意当语言模型请求调用get_current_time函数

85
00:04:17,620 --> 00:04:20,260
AI套件或客户端

86
00:04:20,260 --> 00:04:22,640
将自动调用get_current_time函数

87
00:04:22,640 --> 00:04:25,120
无需手动执行

88
00:04:25,120 --> 00:04:29,660
所有操作均在单个函数调用中完成

89
00:04:29,660 --> 00:04:36,970
需注意其他实现可能需要手动完成此步骤

90
00:04:36,970 --> 00:04:39,050
但使用此特定包

91
00:04:39,050 --> 00:04:40,970
所有操作均封装在客户端中

92
00:04:40,970 --> 00:04:41,890
聊天完成

93
00:04:41,890 --> 00:04:43,490
创建函数调用

94
00:04:43,490 --> 00:04:47,980
现在您已了解如何让语言模型调用函数

95
00:04:47,980 --> 00:04:51,440
希望您在实验室中尝试并享受这个过程

96
00:04:51,440 --> 00:04:56,720
当提供几个函数时效果尤为惊人

97
00:04:56,720 --> 00:05:00,880
模型会采取行动获取更多信息以满足需求

98
00:05:00,880 --> 00:05:02,600
如果您之前未尝试过

99
00:05:02,600 --> 00:05:05,470
相信您会发现这非常酷

100
00:05:05,790 --> 00:05:08,850
事实证明所有工具中最强大的是

101
00:05:08,850 --> 00:05:09,490
这里有一个

102
00:05:09,490 --> 00:05:10,550
这有点特别

103
00:05:10,550 --> 00:05:13,169
这是一个代码执行工具

104
00:05:13,169 --> 00:05:14,669
结果非常强大

105
00:05:14,669 --> 00:05:16,049
如果你能开启

106
00:05:16,049 --> 00:05:17,409
你可以编写代码

107
00:05:17,409 --> 00:05:20,429
我将为你提供一个执行代码的工具

108
00:05:20,429 --> 00:05:22,590
因为代码能做很多事情

109
00:05:22,590 --> 00:05:28,010
我们赋予它编写代码并执行代码的灵活性

110
00:05:28,010 --> 00:05:30,390
这实际上极其强大

111
00:05:30,390 --> 00:05:32,490
提供一个工具给手臂

112
00:05:32,490 --> 00:05:34,710
所以代码执行很特别

113
00:05:34,710 --> 00:05:39,540
让我们进入下一视频，讨论警报的代码执行工具

