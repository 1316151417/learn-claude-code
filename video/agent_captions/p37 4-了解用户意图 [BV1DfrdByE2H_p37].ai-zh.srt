1
00:00:00,140 --> 00:00:03,220
你现在可以开始定义系统中的第一个代理

2
00:00:03,220 --> 00:00:05,180
用户意图代理

3
00:00:05,180 --> 00:00:10,300
其主要目标是帮助你构思可以构建的知识图谱类型

4
00:00:10,300 --> 00:00:13,590
以及你希望从图中回答的问题

5
00:00:13,590 --> 00:00:15,290
让我们开始编码

6
00:00:15,290 --> 00:00:18,270
回想一下我们在第二课中看到的示意图

7
00:00:18,270 --> 00:00:21,090
该图展示了整体知识图谱代理架构

8
00:00:21,090 --> 00:00:24,360
我们将逐步讲解结构化数据代理

9
00:00:24,360 --> 00:00:30,030
这是负责从CSV文件提取信息的子代理

10
00:00:30,030 --> 00:00:32,870
将数据转换为图谱

11
00:00:32,870 --> 00:00:35,610
现在我们将逐步完成这一过程

12
00:00:35,610 --> 00:00:38,130
我们将以这种方式逐步推进

13
00:00:38,130 --> 00:00:43,960
第一步是理解用户意图，这一阶段会发生什么

14
00:00:43,960 --> 00:00:45,120
当我们建立

15
00:00:45,120 --> 00:00:46,300
用户的目标是什么

16
00:00:46,300 --> 00:00:51,300
用户描述的意图将影响所有后续代理的操作

17
00:00:51,300 --> 00:00:54,140
这将为我们的目标设定总体方向

18
00:00:54,140 --> 00:00:57,030
所有代理都会据此做出响应

19
00:00:57,030 --> 00:01:00,650
这个代理只有一个主要任务

20
00:01:00,650 --> 00:01:03,010
其输出是保存到记忆中

21
00:01:03,010 --> 00:01:05,349
已批准的用户目标是什么

22
00:01:05,349 --> 00:01:08,260
为此它有两个工具可用

23
00:01:08,260 --> 00:01:11,500
它有一个工具用于初步感知

24
00:01:11,500 --> 00:01:12,540
用户的意图是什么

25
00:01:12,540 --> 00:01:16,390
基于与用户的对话互动

26
00:01:16,390 --> 00:01:18,230
根据其理解

27
00:01:18,230 --> 00:01:19,170
用户希望

28
00:01:19,170 --> 00:01:20,770
它只能回应

29
00:01:20,770 --> 00:01:21,190
好的

30
00:01:21,190 --> 00:01:22,990
这就是我感知到的需求

31
00:01:22,990 --> 00:01:26,530
因此它会调用工具来捕捉这一信息

32
00:01:26,530 --> 00:01:28,090
然后告知用户

33
00:01:28,090 --> 00:01:29,550
这就是我理解的需求

34
00:01:29,550 --> 00:01:31,890
用户可以选择确认

35
00:01:31,890 --> 00:01:32,930
正确或不正确

36
00:01:32,930 --> 00:01:34,050
不太准确

37
00:01:34,050 --> 00:01:35,210
再试一次

38
00:01:35,210 --> 00:01:36,630
如果你想重新尝试

39
00:01:36,630 --> 00:01:40,410
代理需要继续使用感知到的用户目标

40
00:01:40,410 --> 00:01:41,810
直到用户认为

41
00:01:41,810 --> 00:01:42,870
这就是正确答案

42
00:01:42,870 --> 00:01:44,280
我批准了

43
00:01:44,280 --> 00:01:46,200
只有当用户批准时

44
00:01:46,200 --> 00:01:49,650
代理应调用已批准的感知用户目标

45
00:01:49,650 --> 00:01:51,310
我们将看到这些工具如何协作

46
00:01:51,310 --> 00:01:56,650
更新记忆并捕获已批准的用户目标

47
00:01:56,650 --> 00:02:00,410
注意我通过批判性思考设定感知用户目标

48
00:02:00,410 --> 00:02:03,490
无法直接设定已批准用户目标

49
00:02:03,490 --> 00:02:05,530
只能通过调用此工具

50
00:02:05,530 --> 00:02:07,750
这个机制最终起到守门员作用

51
00:02:07,750 --> 00:02:09,789
确保我们有一个与用户确认的检查点

52
00:02:09,789 --> 00:02:12,870
用户是否明确亲自表示同意

53
00:02:12,870 --> 00:02:13,530
这很好

54
00:02:13,530 --> 00:02:14,870
我们就这样做吧

55
00:02:14,870 --> 00:02:15,310
好的

56
00:02:15,310 --> 00:02:16,890
考虑到代理的详细信息

57
00:02:16,890 --> 00:02:20,910
我们将继续进行常规设置并导入所需库

58
00:02:23,100 --> 00:02:26,620
并设置ln和快速验证检查

59
00:02:28,080 --> 00:02:28,680
让我们看看

60
00:02:28,680 --> 00:02:29,720
这次它的回应如何

61
00:02:30,760 --> 00:02:31,940
相当一致

62
00:02:31,940 --> 00:02:32,400
是的

63
00:02:32,400 --> 00:02:32,800
我准备好了

64
00:02:32,800 --> 00:02:34,880
今天我能为您做些什么

65
00:02:36,860 --> 00:02:40,040
因此我们可以定义用户意图代理本身

66
00:02:40,040 --> 00:02:43,180
我们将从逐步描述开始

67
00:02:43,180 --> 00:02:44,920
我们实际想要的提示是什么

68
00:02:44,920 --> 00:02:47,240
这个代理的指令是什么

69
00:02:47,349 --> 00:02:49,749
需要定义的第一个提示部分

70
00:02:49,749 --> 00:02:52,100
这个代理的角色是什么

71
00:02:52,100 --> 00:02:54,160
还有它的目标是什么

72
00:02:54,160 --> 00:02:55,660
在这里我们将说明

73
00:02:55,660 --> 00:03:00,180
这个代理是知识图谱用例专家

74
00:03:00,329 --> 00:03:04,660
主要目标是帮助用户构思知识图谱用例

75
00:03:04,660 --> 00:03:06,660
这基本上说明你的职责

76
00:03:06,660 --> 00:03:10,180
代理的任务是帮助用户进行创意构思

77
00:03:10,180 --> 00:03:11,780
它试图实现什么

78
00:03:11,780 --> 00:03:13,620
用户试图实现什么

79
00:03:13,620 --> 00:03:18,019
代理的目标是帮助用户明确自身目标

80
00:03:18,019 --> 00:03:20,239
接下来要添加的提示部分

81
00:03:20,239 --> 00:03:21,419
我称之为

82
00:03:21,419 --> 00:03:22,810
对话提示

83
00:03:22,810 --> 00:03:24,990
这有助于代理理解

84
00:03:24,990 --> 00:03:28,870
在其角色和目标的背景下

85
00:03:28,870 --> 00:03:31,149
应该如何开展工作

86
00:03:31,149 --> 00:03:35,109
在此情境下我们正在确定用户意图

87
00:03:35,109 --> 00:03:37,500
致力于与用户进行创意协作

88
00:03:37,500 --> 00:03:39,420
我们有一些基本想法

89
00:03:39,420 --> 00:03:41,100
如果用户不确定该怎么做

90
00:03:41,100 --> 00:03:42,640
可以提供建议

91
00:03:42,640 --> 00:03:45,480
特别是关于知识图谱的经典用例

92
00:03:45,480 --> 00:03:45,700
因为

93
00:03:45,700 --> 00:03:50,260
当然这个代理现在是知识图谱用例专家

94
00:03:50,260 --> 00:03:53,740
也许LMS已经了解很多知识图谱用例

95
00:03:53,740 --> 00:03:56,600
但如果你在构建内部生产系统

96
00:03:56,600 --> 00:04:00,170
某些企业L1可能不了解你的业务

97
00:04:00,170 --> 00:04:01,890
这是一个绝佳机会

98
00:04:01,890 --> 00:04:05,339
向代理解释你们业务的运作方式

99
00:04:05,339 --> 00:04:06,999
以及什么重要什么不重要

100
00:04:06,999 --> 00:04:10,920
在这里我列举了几种知识图谱的用例

101
00:04:10,920 --> 00:04:12,500
你可以将它们用于社交网络

102
00:04:12,500 --> 00:04:13,360
物流

103
00:04:13,360 --> 00:04:14,500
推荐系统

104
00:04:14,500 --> 00:04:15,649
欺诈检测

105
00:04:15,649 --> 00:04:15,849
或者

106
00:04:15,849 --> 00:04:17,069
当然像流行文化这类事物

107
00:04:17,069 --> 00:04:18,389
如果你想追踪电影

108
00:04:18,389 --> 00:04:20,329
书籍或音乐

109
00:04:21,820 --> 00:04:26,260
因为这对确定多亚洲系统的整体方向至关重要

110
00:04:26,420 --> 00:04:27,740
我进一步强化了

111
00:04:27,740 --> 00:04:28,020
比如

112
00:04:28,020 --> 00:04:31,220
用户目标实际上由什么构成

113
00:04:31,220 --> 00:04:35,510
在这里我通过提示描述用户目标包含两个组成部分

114
00:04:35,510 --> 00:04:37,970
一个是图的类型

115
00:04:37,970 --> 00:04:40,310
你是在创建社交图谱吗

116
00:04:40,310 --> 00:04:42,390
还是在创建物流图谱

117
00:04:42,390 --> 00:04:43,670
这可能是什么

118
00:04:43,670 --> 00:04:50,690
因此图的类型需用最多三个词描述

119
00:04:50,690 --> 00:04:52,390
我们正在创建的图是什么

120
00:04:52,390 --> 00:04:55,540
除了你创建的图的类型外

121
00:04:55,540 --> 00:04:58,400
还有描述该图的组件

122
00:04:58,400 --> 00:05:02,400
请提供几句话说明该图的意图

123
00:05:02,400 --> 00:05:03,920
例如

124
00:05:03,920 --> 00:05:07,120
如果我们说美国货运物流

125
00:05:07,120 --> 00:05:12,470
描述可能是动态路由和货物配送系统

126
00:05:12,470 --> 00:05:15,650
这是通过少量示例学习实现的

127
00:05:15,650 --> 00:05:19,730
明确向代理及语言模型强调

128
00:05:19,730 --> 00:05:21,880
你试图实现的目标是什么

129
00:05:21,880 --> 00:05:23,280
因为这非常重要

130
00:05:23,280 --> 00:05:24,220
值得重复强调

131
00:05:24,220 --> 00:05:27,780
既在提示中也将在后续工具描述中

132
00:05:27,780 --> 00:05:30,570
这些工具将实际使用用户目标

133
00:05:30,570 --> 00:05:32,010
在定义其内容时

134
00:05:32,010 --> 00:05:35,460
同时确认理解是否正确

135
00:05:35,540 --> 00:05:38,020
我们将整合提示的最后部分

136
00:05:38,020 --> 00:05:40,380
是思维链的指导方向

137
00:05:40,380 --> 00:05:43,060
思维链可以很简单，比如

138
00:05:43,060 --> 00:05:45,460
仔细思考，分步分析

139
00:05:45,460 --> 00:05:48,080
但这里需要更具体

140
00:05:48,080 --> 00:05:51,480
我们希望语言模型执行某些步骤

141
00:05:51,480 --> 00:05:53,580
因此我们将明确说明

142
00:05:53,580 --> 00:05:56,150
我需要你一步步执行以下操作

143
00:05:56,150 --> 00:05:58,370
代理可能会有不同变体

144
00:05:58,370 --> 00:06:00,210
但通过具体说明

145
00:06:00,210 --> 00:06:01,070
当我们明确

146
00:06:01,070 --> 00:06:03,269
希望代理执行的内容

147
00:06:03,269 --> 00:06:06,929
有助于集中注意力并确定处理方式

148
00:06:06,929 --> 00:06:09,640
根据用户的初始互动

149
00:06:09,760 --> 00:06:13,980
最重要的是需再次理解用户目标

150
00:06:13,980 --> 00:06:14,800
我们将再次强调

151
00:06:14,800 --> 00:06:16,040
这就是那种图表

152
00:06:16,040 --> 00:06:17,600
连同描述一起

153
00:06:17,600 --> 00:06:22,320
如果不能确定代理是否需要询问澄清问题

154
00:06:22,320 --> 00:06:27,640
然后只有当代理认为自己理解了用户目标时才调用集合

155
00:06:27,640 --> 00:06:29,240
感知用户目标工具

156
00:06:29,240 --> 00:06:31,700
这就是实际要记录到内存中的内容

157
00:06:31,700 --> 00:06:36,000
用户目标的理解包含两种组件的图表

158
00:06:36,000 --> 00:06:37,800
连同描述一起

159
00:06:38,080 --> 00:06:40,820
最后呈现这个感知用户目标

160
00:06:40,820 --> 00:06:43,280
通过让用户确认

161
00:06:43,280 --> 00:06:44,920
这就是我刚才听到的内容

162
00:06:44,920 --> 00:06:46,100
我说对了吗

163
00:06:46,100 --> 00:06:48,080
如果用户同意

164
00:06:48,080 --> 00:06:48,420
那么

165
00:06:48,420 --> 00:06:52,520
代理可以调用批准的流程目标工具吗

166
00:06:52,520 --> 00:06:55,340
我们提供了大量关于调用此工具的额外说明

167
00:06:55,340 --> 00:06:58,980
以便代理真正理解这个工具的作用

168
00:06:58,980 --> 00:07:04,130
调用此工具时当前感知目标将保存到状态

169
00:07:04,130 --> 00:07:06,680
在批准用户目标键下

170
00:07:07,200 --> 00:07:07,860
好的

171
00:07:07,860 --> 00:07:10,760
所有这些部分将组成提示

172
00:07:10,760 --> 00:07:14,710
我们将提供给代理以整合这些内容

173
00:07:14,710 --> 00:07:16,820
我们将使用Python字符串模板

174
00:07:16,820 --> 00:07:20,860
然后直接插入之前定义的变量

175
00:07:20,860 --> 00:07:22,140
代理角色和目标

176
00:07:22,140 --> 00:07:23,630
对话提示

177
00:07:23,630 --> 00:07:24,870
输出定义

178
00:07:24,870 --> 00:07:26,670
然后还有思维链指导

179
00:07:27,670 --> 00:07:28,970
我们将其打印到屏幕

180
00:07:28,970 --> 00:07:32,150
你可以看到整体结构

181
00:07:36,720 --> 00:07:39,480
现在可以定义这些工具

182
00:07:40,980 --> 00:07:44,020
第一个工具是设置感知用户目标

183
00:07:44,020 --> 00:07:45,680
在这里的注释中可以看到

184
00:07:45,680 --> 00:07:49,990
这是通过工具设置来促进与用户的协作

185
00:07:49,990 --> 00:07:55,610
仅通过该工具将感知值保存到内存

186
00:07:55,610 --> 00:07:57,770
我们真正帮助代理聚焦

187
00:07:57,770 --> 00:08:00,050
比如如何理解用户目标

188
00:08:00,050 --> 00:08:02,050
因为它必须调用此工具

189
00:08:02,050 --> 00:08:04,130
它知道需要这两个组件

190
00:08:04,130 --> 00:08:05,470
我们在提示中已说明

191
00:08:05,470 --> 00:08:07,250
然后在工具定义中

192
00:08:07,250 --> 00:08:09,270
可以看到这两个参数

193
00:08:09,270 --> 00:08:10,950
必须传入图表类型

194
00:08:10,950 --> 00:08:12,890
以及图表描述

195
00:08:12,890 --> 00:08:18,159
同时注意到工具上下文作为最后一个参数

196
00:08:18,159 --> 00:08:20,019
如果你记得之前的课程

197
00:08:20,019 --> 00:08:22,159
当最后一个参数是工具上下文时

198
00:08:22,159 --> 00:08:24,139
Adk会自动注入

199
00:08:24,139 --> 00:08:26,900
当此工具在工具描述中被调用时

200
00:08:28,060 --> 00:08:32,058
我们再次说明这是在保存感知用户目标

201
00:08:32,058 --> 00:08:33,558
包括这种类型的图表

202
00:08:33,558 --> 00:08:35,159
以及对其的描述

203
00:08:35,159 --> 00:08:37,818
我们还会描述这些参数

204
00:08:37,818 --> 00:08:41,299
这些必须与我们告诉代理的内容完全一致

205
00:08:41,299 --> 00:08:42,639
在之前的指令中

206
00:08:42,639 --> 00:08:44,359
这将成为提示的一部分

207
00:08:44,359 --> 00:08:47,359
现在工具定义本身会再次说明

208
00:08:47,359 --> 00:08:48,879
重复的次数越多

209
00:08:48,879 --> 00:08:51,399
语言模型越不可能出错

210
00:08:51,399 --> 00:08:53,910
在调用工具和工具内部

211
00:08:53,910 --> 00:08:54,730
其实很简单

212
00:08:54,730 --> 00:08:57,910
它只需组装一个小字典

213
00:08:57,910 --> 00:09:01,680
这是由这两个组件组成的用户目标数据

214
00:09:01,680 --> 00:09:02,720
这种类型的图表

215
00:09:02,720 --> 00:09:05,870
以及传入工具的图表描述

216
00:09:05,870 --> 00:09:10,610
这实际上只是简单封装如何访问记忆的方法

217
00:09:10,610 --> 00:09:13,390
同时聚焦记忆访问

218
00:09:13,390 --> 00:09:16,520
上下文状态会更新该字典

219
00:09:16,520 --> 00:09:18,360
因为这是更新操作

220
00:09:18,360 --> 00:09:21,380
ADK会检测到状态变化

221
00:09:21,380 --> 00:09:24,890
会将该差异传递给需要感知的其他方

222
00:09:24,890 --> 00:09:25,410
嗯

223
00:09:25,410 --> 00:09:27,530
在运行时环境中

224
00:09:29,940 --> 00:09:31,660
然后定义下一个工具

225
00:09:31,660 --> 00:09:34,630
用于批准感知到的用户目标

226
00:09:34,630 --> 00:09:39,330
这应在设置感知用户目标后触发

227
00:09:39,330 --> 00:09:41,270
然后用户也明确同意

228
00:09:41,270 --> 00:09:44,060
如果这两项都成立

229
00:09:44,060 --> 00:09:46,850
现在应调用此工具

230
00:09:46,850 --> 00:09:47,790
在可以时

231
00:09:47,790 --> 00:09:49,770
在可行且合理时

232
00:09:49,770 --> 00:09:50,770
在工具内部

233
00:09:50,770 --> 00:09:52,190
值得信任

234
00:09:52,190 --> 00:09:56,579
但需验证语言模型在此工具中的正确性

235
00:09:56,579 --> 00:09:59,199
这仅在用户批准后调用

236
00:09:59,199 --> 00:10:00,479
我们将再次迭代

237
00:10:00,479 --> 00:10:01,879
与语言模型

238
00:10:01,879 --> 00:10:02,339
嘿

239
00:10:02,339 --> 00:10:05,180
仅在用户批准后调用

240
00:10:05,180 --> 00:10:07,980
如果用户通过调用此工具批准

241
00:10:07,980 --> 00:10:12,330
工具将记录感知目标为已批准目标

242
00:10:12,330 --> 00:10:14,230
再次告知代理

243
00:10:14,230 --> 00:10:15,390
仅调用此工具

244
00:10:15,390 --> 00:10:22,150
若用户已在工具内明确批准感知目标

245
00:10:22,150 --> 00:10:25,410
因为我们已设置流程

246
00:10:25,410 --> 00:10:29,010
可在执行其他操作前先检查是否已设置

247
00:10:29,010 --> 00:10:29,550
现在

248
00:10:29,550 --> 00:10:31,610
如何处理此设置至关重要

249
00:10:31,610 --> 00:10:36,090
因为工具调用可能成功或出错

250
00:10:36,090 --> 00:10:39,530
这里我们可能返回特定错误

251
00:10:39,530 --> 00:10:42,979
如果感知到的用户目标不在当前上下文中

252
00:10:42,979 --> 00:10:45,519
如果它不在工具上下文状态中

253
00:10:45,519 --> 00:10:46,999
因此，代理的记忆

254
00:10:46,999 --> 00:10:49,230
如果感知到的用户目标不存在

255
00:10:49,230 --> 00:10:51,610
我们将继续从该工具返回错误

256
00:10:51,610 --> 00:10:56,490
我们将提供的错误信息旨在帮助语言模型理解

257
00:10:56,490 --> 00:10:58,390
这就是哪里出错了

258
00:10:58,390 --> 00:11:00,490
这就是你应该如何解决问题

259
00:11:00,490 --> 00:11:04,220
因此我们告知LLM过程用户目标未被设置

260
00:11:04,220 --> 00:11:08,540
并应先设置感知用户目标或询问澄清问题

261
00:11:08,540 --> 00:11:12,260
如果不确定用户的意图

262
00:11:12,340 --> 00:11:16,240
因此在所有这些地方反复强调给代理

263
00:11:16,240 --> 00:11:18,980
从提示到工具的定义

264
00:11:18,980 --> 00:11:21,490
再到工具返回的错误信息

265
00:11:21,490 --> 00:11:25,690
鼓励LLM根据实际情况采取正确行动

266
00:11:25,690 --> 00:11:26,870
如果成功的话

267
00:11:26,870 --> 00:11:32,590
我们只需将感知用户目标的状态复制到批准用户目标

268
00:11:32,590 --> 00:11:34,710
请注意只有在以下情况下才会发生

269
00:11:34,710 --> 00:11:38,290
由于我们没有向批准感知用户目标传递参数

270
00:11:38,290 --> 00:11:40,470
批准用户目标仅会被设置

271
00:11:40,470 --> 00:11:42,150
如果存在感知用户目标

272
00:11:42,150 --> 00:11:43,390
则会被复制

273
00:11:43,390 --> 00:11:49,629
此时感知和批准用户目标都应在状态中可用

274
00:11:49,629 --> 00:11:51,189
我们将这两个都添加到列表中

275
00:11:51,189 --> 00:11:55,120
因为我们知道在创建实际代理时需要传递列表

276
00:11:55,120 --> 00:12:00,760
我们有两个工具：设置感知用户目标和批准感知用户目标

277
00:12:00,880 --> 00:12:03,540
因此你可以定义用户意图代理

278
00:12:03,540 --> 00:12:04,840
你需要为其命名

279
00:12:04,840 --> 00:12:07,800
使用唯一的版本名称

280
00:12:07,800 --> 00:12:10,580
我们将使用之前定义的LLM

281
00:12:10,580 --> 00:12:12,880
这将是所有笔记本中相同的LLM

282
00:12:12,880 --> 00:12:15,310
未来可以直接跳过这一步

283
00:12:15,310 --> 00:12:16,790
描述非常重要

284
00:12:17,870 --> 00:12:24,400
该用户意图代理的目的是帮助用户构思知识图谱用例

285
00:12:24,400 --> 00:12:26,740
这有助于整个多代理系统

286
00:12:26,740 --> 00:12:29,060
判断何时使用该代理

287
00:12:29,060 --> 00:12:31,100
你之前从图表中回忆

288
00:12:31,100 --> 00:12:36,299
通过描述匹配该代理在工作流中的角色

289
00:12:36,299 --> 00:12:41,190
这将帮助协调者管理整个工作流

290
00:12:44,430 --> 00:12:48,549
然后我们使用之前组装的完整代理指令

291
00:12:48,549 --> 00:12:49,869
我们将传入这些指令

292
00:12:49,869 --> 00:12:51,389
当然我们还会传入

293
00:12:51,389 --> 00:12:52,989
可用的工具

294
00:12:55,440 --> 00:12:58,240
现在你已准备好完整的用户代理

295
00:12:58,240 --> 00:13:00,400
让我们与之交互

296
00:13:00,670 --> 00:13:01,910
你可以导入你的朋友

297
00:13:01,910 --> 00:13:03,750
创建代理调用器

298
00:13:03,750 --> 00:13:07,650
然后为用户意图代理创建一个调用器

299
00:13:07,650 --> 00:13:09,850
我们将调用用户意图调用器

300
00:13:09,850 --> 00:13:11,970
你可以注意这里的这个便签

301
00:13:11,970 --> 00:13:12,510
当然

302
00:13:12,510 --> 00:13:13,990
如果你要多次运行这个流程

303
00:13:13,990 --> 00:13:16,890
值得回来重新初始化状态

304
00:13:16,890 --> 00:13:20,210
如果事情有点失控的话

305
00:13:22,180 --> 00:13:26,300
现在我们来设置一个与用户意图代理的对话

306
00:13:26,580 --> 00:13:29,040
在实际交互前先获取会话

307
00:13:29,040 --> 00:13:31,300
这样可以看到当前会话状态

308
00:13:31,300 --> 00:13:32,300
这应该为空

309
00:13:32,300 --> 00:13:34,089
最初就像往常一样

310
00:13:34,089 --> 00:13:37,469
然后我们将创建一个脚本化对话

311
00:13:37,469 --> 00:13:40,449
这里只有两个调用步骤

312
00:13:40,449 --> 00:13:42,050
第一个调用

313
00:13:42,410 --> 00:13:43,290
这将是用户

314
00:13:43,290 --> 00:13:48,440
声明用户想要物料清单图或BM图

315
00:13:48,440 --> 00:13:51,780
并包含物料清单的所有层级

316
00:13:51,780 --> 00:13:53,840
从供应商到成品

317
00:13:54,840 --> 00:13:59,220
用户还指定需要这个物料清单图

318
00:13:59,220 --> 00:14:01,720
能够支持根本原因分析

319
00:14:01,870 --> 00:14:05,070
我现在去掉详细输出

320
00:14:05,070 --> 00:14:05,830
但你可以保留

321
00:14:05,830 --> 00:14:07,350
如果你想的话

322
00:14:07,350 --> 00:14:09,640
这是对话的重要部分

323
00:14:09,640 --> 00:14:13,760
有时当代理收到用户的初始消息时

324
00:14:13,760 --> 00:14:15,020
它可能会决定

325
00:14:15,020 --> 00:14:17,220
我需要进一步澄清

326
00:14:17,220 --> 00:14:19,050
如果发生这种情况

327
00:14:19,050 --> 00:14:21,350
则用户目标未被设置

328
00:14:21,350 --> 00:14:24,310
代理可能回应说嘿

329
00:14:24,310 --> 00:14:26,920
告诉我更多关于你的需求

330
00:14:26,920 --> 00:14:28,080
我们在此做假设

331
00:14:28,080 --> 00:14:31,300
如果会话状态中用户目标未设置

332
00:14:31,300 --> 00:14:34,940
假设LLM被要求提出澄清问题

333
00:14:34,940 --> 00:14:40,350
我们以用户身份提供澄清回答

334
00:14:40,350 --> 00:14:43,910
我担心可能的制造或供应商问题

335
00:14:43,910 --> 00:14:46,810
希望这些细节足够让代理满意

336
00:14:46,810 --> 00:14:51,060
并促使它调用用户目标工具

337
00:14:51,260 --> 00:14:52,340
乐观地

338
00:14:52,340 --> 00:14:53,380
如果我们走到这一步

339
00:14:53,380 --> 00:14:55,480
则流程目标已设置

340
00:14:55,480 --> 00:14:57,020
然后我们将说

341
00:14:57,020 --> 00:14:57,320
嗯

342
00:14:57,320 --> 00:14:58,240
听起来不错

343
00:14:58,240 --> 00:14:59,900
我批准这个目标

344
00:14:59,900 --> 00:15:05,340
你可能需要多次运行以防代理未设置用户目标

345
00:15:05,340 --> 00:15:10,550
它可能在某天决定先与用户多交流

346
00:15:10,550 --> 00:15:12,010
确定真正需要什么

347
00:15:12,010 --> 00:15:15,960
用户目标没问题

348
00:15:15,960 --> 00:15:19,460
我在最终调用批准目标时启用了调试

349
00:15:19,460 --> 00:15:21,400
但你可以看到我们在此会话中的过程

350
00:15:21,400 --> 00:15:24,339
会话开始时会话为空

351
00:15:24,339 --> 00:15:26,190
内存状态为空

352
00:15:26,190 --> 00:15:29,890
用户发送了初始消息并收到代理回应

353
00:15:29,890 --> 00:15:32,440
实际上在询问澄清问题

354
00:15:32,440 --> 00:15:33,320
所以它说嘿

355
00:15:33,320 --> 00:15:36,080
你是在尝试从供应商追溯产品的组件

356
00:15:36,080 --> 00:15:38,460
通过制造过程的各个阶段

357
00:15:38,460 --> 00:15:40,960
这是代理的相当长的回答

358
00:15:40,960 --> 00:15:41,900
这没问题

359
00:15:41,900 --> 00:15:44,440
由于我们设置了检查机制

360
00:15:44,440 --> 00:15:46,160
我们继续决定

361
00:15:46,160 --> 00:15:46,819
好的

362
00:15:46,819 --> 00:15:49,959
我们意识到用户的感知目标未设置

363
00:15:49,959 --> 00:15:51,459
我们发送了额外消息给

364
00:15:51,459 --> 00:15:54,829
我担心可能出现制造或供应问题

365
00:15:55,189 --> 00:15:59,579
看来代理随后回应并决定

366
00:15:59,579 --> 00:15:59,779
好的

367
00:15:59,779 --> 00:16:01,739
这已足够继续

368
00:16:01,739 --> 00:16:04,670
然后理解了我们的目标

369
00:16:04,670 --> 00:16:06,030
并告诉我们

370
00:16:06,030 --> 00:16:06,980
好的

371
00:16:06,980 --> 00:16:08,160
这就是你想要的图表类型

372
00:16:08,160 --> 00:16:09,460
我想你在尝试构建

373
00:16:09,460 --> 00:16:11,020
这就是我的理解

374
00:16:11,020 --> 00:16:14,010
你希望该图表描述的内容

375
00:16:14,010 --> 00:16:15,410
最后它说道

376
00:16:15,410 --> 00:16:16,250
正确

377
00:16:16,250 --> 00:16:16,690
嘿

378
00:16:16,690 --> 00:16:18,280
这是否符合你的意图

379
00:16:18,280 --> 00:16:20,040
正是我们想要做的

380
00:16:20,040 --> 00:16:21,020
我们想说

381
00:16:21,020 --> 00:16:23,080
这就是我认为你在询问的内容

382
00:16:23,080 --> 00:16:24,800
这正确吗

383
00:16:24,800 --> 00:16:28,440
然后作为用户我们将批准该目标

384
00:16:28,440 --> 00:16:31,110
这是我们之前决定的对话记录

385
00:16:31,110 --> 00:16:33,010
可以看到在优化目标时

386
00:16:33,010 --> 00:16:37,900
用户意图代理设置了感知用户目标

387
00:16:37,900 --> 00:16:41,760
实际上尚未设置流程目标

388
00:16:41,760 --> 00:16:43,160
或再次调用它

389
00:16:43,160 --> 00:16:44,780
看起来实际上

390
00:16:44,780 --> 00:16:49,930
然后在设定感知用户目标后

391
00:16:49,930 --> 00:16:51,470
因为用户已批准

392
00:16:51,470 --> 00:16:54,710
调用已批准的感知用户目标

393
00:16:55,900 --> 00:16:56,400
好的

394
00:16:56,400 --> 00:16:58,160
你可以看到底部的最终回复

395
00:16:58,160 --> 00:17:00,340
用户目标已成功批准

396
00:17:00,340 --> 00:17:02,120
一切正常

397
00:17:02,120 --> 00:17:05,579
工作流程现在明确了用户的目标方向

398
00:17:05,579 --> 00:17:09,119
在多代理系统中构建知识图谱

